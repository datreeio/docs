---
title: ☑️ Prevent exposed Vault secrets in objects
slug: /built-in-rules/prevent-exposed-secrets-vault
---

import CommonOverview from '../common-overview.mdx'
import CommonHowToFix from '../common-how-to-fix.mdx'

<CommonOverview />

**Policy as code identifier:** ALL_EXPOSED_SECRET_VAULT

---

## This rule will fail

If a Vault **batch token and/or service token** are present anywhere in the config:

```yaml
BATCH_TOKEN: hvb.pehm8c_dqgtzfp9nlgj55the9epkubbyyvr3hcqksrytd5sxpdspxgkedgapgcykmx1ao-5f2hshknklvpuf49cuoovi_v61ssbto_ztwd8ps1dbmkeb_-f5vd_tln5gu8k0cczqeb06neqf0m-u7qrk
SERVIVE_TOKEN: hvs.aiky6mstgd0g9r-epdtfcghy32mzi6cm83z02emx80-1-m5bntqc9xf3e9qjcaw24vd1how4ptt0lssm7e637nox8skbz
```

### Rule output in the CLI

```terminal
$ datree test *.yaml

>> File: failExample.yaml
❌ Prevent exposed Vault secrets in objects [1 occurrence]
💡 Secret data found in config - keep your sensitive data elsewhere to prevent it from being stolen 
```

---

## How to fix this failure

<CommonHowToFix />

---

## Read more

- [Distribute Credentials Securely Using Secrets](https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/)
