---
title: â˜‘ï¸ Prevent EndpointSlice validation from enabling host network hijack (CVE-2021-25737)
slug: /built-in-rules/prevent-endpointslice-validation-from-enabling-host-network-hijack-cve-2021-25737
---

A vulnerabilityÂ has been foundÂ in KubernetesÂ *kube-apiserverÂ *in which an authorized user could redirect pod traffic to private networks on a node ([NVD](https://nvd.nist.gov/vuln/detail/CVE-2021-25737) severity of this issue: **Low**).

By exploiting the vulnerability, attackers can hijack your clusterâ€™s network traffic, potentially leading to sensitive data leaks.

**Targeted resources by this rule (types of **`kind`**): **EndpointSlice

**Enabled by default?** False

**Policy as code identifier:** ENDPOINTSLICE_CVE2021_25373_INCORRECT_ADDRESSES_VALUE

---

## This rule will fail

If anÂ EndpointSlice is created or modifiedÂ with `endpoints.addresses` in theÂ **127.0.0.0/8**Â andÂ **169.254.0.0/16**Â internal ranges.

```yaml
kind: EndpointSlice
endpoints:
  - addresses:
      - "169.254.23.4"
```

### Rule output in the CLI

```terminal
$ datree test *.yaml

>> File: failExample.yaml
âŒ Prevent EndpointSlice validation from enabling host network hijack (CVE-2021-25737) [1 occurrence]
ğŸ’¡ Incorrect value\s for key 'addresses' - address is within vulnerable ranges (127.0.0.0/8 and 169.254.0.0/16)
```

---

## How to fix this failure

Use endpoint addresses that are not in the vulnerable ranges (**127.0.0.0/8**Â andÂ **169.254.0.0/16**).

```yaml
kind: EndpointSlice
endpoints:
  - addresses:
      - "172.23.47.4"
```

---

## Read more[](https://www.datree.io/resources/kubernetes-configuration-mistakes#anchor3)

- [CVE-2021-25737: Holes in EndpointSlice Validation Enable Host Network HijackÂ #102106](https://github.com/kubernetes/kubernetes/issues/102106)

- [Kubernetes docs - EndpointSlices](https://kubernetes.io/docs/concepts/services-networking/endpoint-slices/)
