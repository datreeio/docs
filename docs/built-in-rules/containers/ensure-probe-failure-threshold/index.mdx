---
title: ☑️ Ensure each container probe has a configured failure threshold
slug: /built-in-rules/ensure-probe-failure-threshold
---

Probes have a number of fields that are used to control the behavior of liveness and readiness checks. A defect was found in one of these fields causing it to be ignored, and was corrected in Kubernetes v1.20.  
To prevent such cases where unknown default behavior is used, we suggest to explicitly set these fields with your desired values. See the *Read more* section below for more information.  
When a probe fails, Kubernetes will try `failureThreshold` times before giving up. The field has a default value of 3, and a minimum value of 1.

**Targeted resources by this rule (types of **`kind`**): **Deployment / Pod / DaemonSet / StatefulSet / ReplicaSet / CronJob / Job

**Enabled by default?** False

**Policy as code identifier:** CONTAINERS_INCORRECT_FAILURETHRESHOLD_VALUE

---

## This rule will fail

If a container has a `livenessProbe`, `readinessProbe` and/or `startupProbe` configured, but the field `failureThreshold` is not configured or has a value smaller than 1

```yaml
spec:
  containers:
    - readinessProbe:
        periodSeconds: 1
```
```yaml
spec:
  containers:
    - readinessProbe:
        failureThreshold: 0
```

### Rule output in the CLI

```terminal
$ datree test *.yaml

>> File: failExample.yaml
❌ Ensure each container probe has a configured failure threshold [1 occurrence]
💡 Incorrect value for key `failureThreshold` - set explicitly to control the number of retries after a probe fails (min 1)
```

---

## How to fix this failure

Each each container probe has a configured `failureThreshold` property with a minimum value of 1

```yaml
spec:
  containers:
    - readinessProbe:
        failureThreshold: 3
```

---

## Read more

- [Kubernetes docs - configure probes](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#configure-probes)