---
title: Behavior
slug: /configuration/behavior
---

## Dashboard vs. Helm chart configuration

By default, the following options are configurable via your [dashboard](https://app.datree.io/clusters):
- **Action on failure** - Select whether to monitor or block resources that fail the policy check (defaults to "monitor").
- **Active policy** - The name of the policy to check (defaults to "Starter").
- **Ignored resources** - Resources to be ignored, in regex format, specified by namespace/kind/name or any combination of the three. See examples [here](/configuration/behavior#example-patterns).

If you wish to control these options via the Datree Helm chart instead, you can do so by changing the value of the `configFromHelm` parameter. Simply run the following command:
```terminal
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook --reuse-values --set datree.configFromHelm=true
```
Then, change your desired parameters as described in the table below.  
Run a [manual scan](/configuration/cluster-scan#manual-scan) to update your dashboard.


:::caution Important
* When controlling these options via the dashboard, changing them via the Helm chart will have no effect.  
* All other configuration options (see table below) are always controlled via the helm chart.
:::

## Options

The following options (Helm chart parameters) are available for configuring Datree's behavior:

| **Option**          | **Description**                                                                      | **Type** |
| ------------------- | ------------------------------------------------------------------------------------ | -------- |
| `configFromHelm`    | Determines whether the options listed [here](/configuration/behavior#dashboard-vs-helm-chart-configuration) are managed from Helm chart or from the dashboard (default: false) | boolean |
| `enforce`           | Block resources that fail the policy check from being applied to the cluster.<br/>*Relevant only if `configFromHelm` is `true`* | boolean  |
| `policy`            | The name of the policy to check, e.g: "Argo".<br/>*Relevant only if `configFromHelm` is `true`* | string |
| `customSkipList`    | Skip resources by namespace/kind/name. See [custom skipping](/configuration/behavior#custom-skipping) for details.<br/>*Relevant only if `configFromHelm` is `true`*               | Object |
| `clusterName`       | The name of the cluster to be displayed in your dashboard                            | string   |
| `scanIntervalHours` | The number of hours between cluster scans                                            | number   |
| `existingSecret`    | A reference to a `Secret` object containing a Datree token                           | Object   |
| `token`             | The token used to link the CLI to your dashboard                                     | string   |
| `verbose`           | Display 'How to Fix' link for failed rules in output                                 | boolean  |
| `output`            | The format output of the policy check results: yaml, json, xml, simple, JUnit, sarif | string   |
| `noRecord`          | Don‚Äôt send policy checks metadata to the dashboard                                   | boolean  |

‚ÑπÔ∏è _For the full list of configurable parameters in the Datree helm chart, click [here](https://github.com/datreeio/admission-webhook-datree#values)_

### Configure options

To set/change one or more options, choose one of the following methods:

#### 1. Using a Helm inline command

The following example will enable enforce mode and block resources that fail the policy check:

```terminal
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook --reuse-values --set datree.enforce="true"
```

#### 2. Using a new Helm values file

Create a YAML file with your desired values, then run the following command to apply it:

```terminal
helm upgrade -n datree -f newValues.yaml datree-webhook datree-webhook/datree-admission-webhook
```

---

## Set/change token

Since your token is sensitive ü§´ and you would not want to keep it in your repository, we recommend to set/change it using the `helm upgrade` command. You can do this one of two ways:

1. Via the `datree.token` parameter:

```terminal
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook --reuse-values --set datree.token=<your-token>
```

Simply replace `<your-token>` with your actual [token](https://app.datree.io/settings/token-management).

<br />

2. Via the `datree.existingSecret` parameter:
   To use this option, you will need to create a `Secret` object containing your token and apply it to your cluster. Then, run this command:

```terminal
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook --reuse-values --set datree.existingSecret.name=<secret-name> --set datree.existingSecret.key=<secret-key>
```

Replace `<secret-name>` with the name of the secret containing your token.  
Replace `<secret-key>` with the key within the secret that contains your token.

:::info NOTE
If both options are set, the `datree.existingSecret` will take precedence.
:::

---

## Custom skipping

Datree can be configured to skip certain rules/resources by using a dedicated `ConfigMap`.  
The `ConfigMap` is a part of the Datree Helm chart, under the parameter `datree.customSkipList`.  
You can use it to skip a `namespace`, `kind`, `name`, or any combination of the three.

To add an entry to the `ConfigMap`:

**1.** In your `values.yaml` file, add the following parameter:

```yaml
datree:
  customSkipList:
    - "(.*);(.*);(.*)" # "namespace;kind;name"
```

Replace `(.*);(.*);(.*)` with your desired values (see examples below). You can use a regular expression for any of the aformentioned properties.

**2.** Run a `helm upgrade`/`helm install` command to apply your changes:

```terminal
helm repo update
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook -f values.yaml --reuse-values --debug
```

:::info NOTE
By default, Datree skips all resources with a name starting with `aws-node`.  
This entry is already included in the default `values.yaml` file.
:::

### Example patterns

The following pattern will cause Datree to skip all resources in the namespace 'myNs':

```
myNs;(.*);(.*)
```

The following pattern will cause Datree to skip all resources of kind `ServiceAccount`, regardless of their namespace:

```
(.*);ServiceAccount;(.*)
```

The following pattern will cause Datree to skip all resources in all namespaces if the resource name starts with the prefix 'appName-':

```
(.*);(.*);(^appName-.*)
```

---

## Ignore a namespace

Add the label `"admission.datree/validate=skip"` to the configuration of the namespace you would like to ignore:

```terminal
kubectl label namespaces default "admission.datree/validate=skip"
```

To delete the label and resume running the datree webhook on the namespace again:

```terminal
kubectl label namespaces default "admission.datree/validate-"
```

---

## Skip specific rules for a single object

To skip a rule for a specific object, add the following annotation to its manifest:

```yaml
datree.skip/[identifier]: [message]
```

**identifier** - the unique rule identifier.  
**message** - optional text to be presented in the policy check output (CLI and activity-log tab at the dashboard). <br/><br/>

To obtain identifiers of _built-in rules_, go to your [dashboard](https://app.datree.io/cli/policies/) and click on the 'i' icon of your desired rule:

![rule_i](/img/configuration/behavior/1.png)

This will lead you to the documentation of the rule, where you will find the identifier:

![rule_identifier_docs](/img/configuration/behavior/2.png)

Identifiers of [_custom rules_](/custom-rules/custom-rules-overview) can be found in the policy.yaml file, when in Policy-as-code mode. For example:

```yaml
customRules:
  - identifier: CUSTOM_WORKLOAD_INCORRECT_ENVIRONMENT_LABELS
    name: Ensure correct environment labels are used [CUSTOM RULE]
    defaultMessageOnFailure: Use only approved environment labels ('prod', 'staging' and 'test')
    schema:
```

#### Example of a Deployment with skipped rules:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rss-site
  namespace: test
  labels:
    environment: prod
    app: web
  annotations:
    datree.skip/WORKLOAD_INVALID_LABELS_VALUE: irrelevant for deployments, skipping.
    datree.skip/CONTAINERS_MISSING_LIVENESSPROBE_KEY: irrelevant for prod environment, skipping.
```

:::info Note
`annotations` have a character limit - the key and value of an annotation cannot exceed 63 characters each.  
For more information, see the [Kubernetes docs](https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/#syntax-and-character-set)
:::

---

## Update

To update Datree to the latest version, run the following commands:

```terminal
helm repo update
helm upgrade -n datree datree-webhook datree-webhook/datree-admission-webhook --reuse-values --debug
```

---

## Uninstall

To uninstall Datree, run the following commands:

```terminal
helm uninstall datree-webhook -n datree
kubectl delete ns datree
```
